# Post-Implementation Checklist & Refinements

**Source:** Deep-Dive Technical Audit (Dec 26, 2025) + Persona Analysis (Dec 27, 2025)
**Status:** To Be Scheduled
**Priority:** High (Usability & Scalability)

This document outlines tasks identified during the final audit of the FinOps module implementation. These items are critical for moving from "Functional" to "World Class" usability.

---

## 1. UX Enhancements (Friction Reduction)

### 1.1 Dunning History Visibility
- [ ] **Task:** Add a "Communication Timeline" to the Invoice Detail modal/view.
- [ ] **Goal:** Allow Finance Admins to see exactly when automated reminders (3-day, due-date, 7-day overdue) were sent without checking raw logs.
- [ ] **Implementation:**
    - Create `InvoiceActivityLog` component.
    - Query `billing_logs` where `invoice_id` matches and `event_type` is 'notification'.

### 1.2 Procurement Queue (Vendor Orders)
- [ ] **Task:** Create a simple "Procurement Queue" view.
- [ ] **Goal:** Track status of hardware orders generated by the Quote-to-Cash flow before the full Phase 5.4 procurement module is built.
- [ ] **Implementation:**
    - View: `Modules/Billing/Resources/views/admin/procurement/index.blade.php`
    - Columns: Quote #, Vendor, Items, Status (Ordered/Shipped/Received), Tracking #.

### 1.3 Bulk Price Override Manager
- [ ] **Task:** Implement a "Bulk Update" feature for Price Overrides.
- [ ] **Goal:** Allow updating 50+ clients' pricing at once (e.g., annual vendor price increase).
- [ ] **Implementation:**
    - UI: Checkbox selection on Overrides table.
    - Action: "Apply % Increase" or "Set Fixed Price".
    - Backend: Job to process updates in background to avoid timeouts.

### 1.4 Technician Daily Timesheet
- [ ] **Task:** Create a "Daily Timesheet" view for technicians.
- [ ] **Goal:** Reduce friction of opening individual tickets to log time.
- [ ] **Implementation:**
    - View: `Modules/Billing/Resources/views/field/timesheet.blade.php`
    - Interface: Grid view of today's tickets with inline "Hours" and "Billable" toggle.
    - Action: "Submit Day" button.

---

## 2. Architecture & Scalability Refinements

### 2.1 JSON Column Optimization
- [ ] **Task:** Review usage of `companies.billing_address` and `subscriptions.metadata`.
- [ ] **Goal:** Ensure fields needed for *filtering* are not trapped in JSON.
- [ ] **Action:**
    - If "Filter by State/Region" is required, promote `state` to a dedicated column on `companies`.
    - If "Filter by RMM Device ID" is required, ensure it's indexed or in a related table, not just JSON metadata.

### 2.2 Performance Tuning
- [ ] **Task:** Verify indexing on high-traffic join columns.
- [ ] **Checklist:**
    - [ ] `billable_entries.ticket_id` (for joining with Helpdesk)
    - [ ] `invoices.company_id` + `invoices.status` (compound index for dashboards)
    - [ ] `subscriptions.next_billing_date` (for the billing runner)

---

## 3. Documentation Updates

- [ ] **Task:** Update "Finance Admin Guide" to include the new "Bulk Override" workflow.
- [ ] **Task:** Update "Technician Guide" to explain the "Daily Timesheet" vs. "Ticket Billing" options.

---

## 4. UX Flow Improvements (From UX_FLOW_ANALYSIS.md)

### 4.1 Quote-to-Cash Flow
- [ ] **Task:** Add quote view tracking (record when client opens quote link).
- [ ] **Task:** Send notification to Sales Agent when quote is viewed.
- [ ] **Task:** Add "Accept & Sign" button to public quote view for digital acceptance.
- [ ] **Task:** Add "Convert to Invoice" button on internal Quote detail view.
- [ ] **Task:** Create Quote Pipeline/Kanban dashboard (`/billing/quotes/pipeline`).

### 4.2 Pre-Flight Review Clarity
- [ ] **Task:** Clarify "Approve" vs "Send" actions (separate buttons or "Approve & Send").
- [ ] **Task:** Add confirmation toast: "5 invoices approved and sent to clients."
- [ ] **Task:** Add audit trail to Invoice detail showing who approved and when.

### 4.3 Technician Time → Invoice Feedback Loop
- [ ] **Task:** Add "Invoice Status" column to BillableEntry list (Pending / Invoiced / N/A).
- [ ] **Task:** Create "My Unbilled Time" view for technicians.
- [ ] **Task:** Link BillableEntry to Invoice line item after billing run.

### 4.4 Client Onboarding Wizard
- [ ] **Task:** Create "New Client Setup Wizard" with guided steps.
- [ ] **Steps:** Company Info → Pricing Tier → Initial Subscription → First Invoice (optional).
- [ ] **Goal:** Reduce multi-screen friction for Finance Admins.

### 4.5 Dispute Handling Workflow
- [ ] **Task:** Add `is_disputed` boolean flag to Invoice model.
- [ ] **Task:** Add `internal_notes` text field to Invoice model.
- [ ] **Task:** Create "Flag as Disputed" action that pauses dunning.
- [ ] **Task:** Create Credit Note model and issuance workflow.

---

## 5. Finance Admin Enhancements

### 5.1 AR & Collections
- [ ] **Task:** Add `dunning_paused` flag to Invoice model.
- [ ] **Task:** Add "Pause Dunning" toggle on Invoice detail view.
- [ ] **Task:** Wire "Export to Excel" button on Pre-Flight Review.

### 5.2 Advanced Reporting
- [ ] **Task:** Add "Effective Hourly Rate" metric to Profitability Dashboard.
- [ ] **Task:** Add industry benchmark comparison (Phase 5.1 - HTG/Service Leadership API).

### 5.3 Pre-Paid Hour Blocks (Retainers)
- [ ] **Task:** Create `Retainer` model (company_id, hours_purchased, hours_remaining, expires_at).
- [ ] **Task:** Create retainer purchase workflow (sell hour blocks to clients).
- [ ] **Task:** Auto-deduct from retainer when BillableEntry is logged.
- [ ] **Task:** Add "Retainer Balance" widget to Company profile.
- [ ] **Task:** Add "Buy More Hours" notification when balance < threshold.

### 5.4 Adjustments & Disputes
- [ ] **Task:** Create `CreditNote` model (invoice_id, amount, reason, issued_by).
- [ ] **Task:** Add "Issue Credit Note" action on Invoice detail.
- [ ] **Task:** Add "Disputed" visual badge on Invoice list/detail.
- [ ] **Task:** Add internal notes section to Invoice detail (not visible to client).

---

## 6. Technician Enhancements

### 6.1 Time Tracking Efficiency
- [ ] **Task:** Create "My Stats" dashboard (`/billing/technician/stats`).
- [ ] **Metrics:** Billable hours today/week/month, utilization %, revenue generated.

### 6.2 Parts & Inventory
- [ ] **Task:** Integrate barcode scanner for adding parts to tickets.
- [ ] **Task:** Display real-time stock levels in "Add Part" modal.
- [ ] **Task:** Warn if selected part is out of stock.

### 6.3 Context Awareness
- [ ] **Task:** Show "Past Due" warning badge on Work Order if client AR > 60 days.
- [ ] **Task:** Show "Covered by Contract" indicator if service is included in AYCE subscription.

### 6.4 Expense Management
- [ ] **Task:** Add file upload (photo) to Expense modal.
- [ ] **Task:** Store receipts in Media library linked to BillableEntry.

---

## 7. Client Admin Enhancements (Portal)

### 7.1 Payments
- [ ] **Task:** Add "Enable Auto-Pay" toggle in Portal Payment Methods tab.
- [ ] **Task:** Add "Download PDF" button on Invoice detail in Portal.

### 7.2 Purchasing
- [ ] **Task:** Add "Accept Quote" button with e-signature on public quote view.
- [ ] **Task:** Add "Order Status" section in Portal showing hardware order tracking.

### 7.3 Account Management
- [ ] **Task:** Add "Company Profile" section in Portal for billing address updates.
- [ ] **Task:** Enable client-side user management in Portal Team view.

### 7.4 Retainer Visibility
- [ ] **Task:** Add "Pre-Paid Hours Balance" widget to Portal dashboard.
- [ ] **Task:** Add "Hour Usage Report" showing deductions by ticket/technician.

### 7.5 Transparency & Disputes
- [ ] **Task:** Add ticket/user breakdown to invoice line items in Portal.
- [ ] **Task:** Add "Dispute This Charge" button on Portal invoice detail.

---

## 8. Sales Agent Enhancements

### 8.1 Quote Management
- [ ] **Task:** Create Quote Pipeline dashboard (Kanban: Draft → Sent → Viewed → Accepted → Lost).
- [ ] **Task:** Add "Duplicate Quote" action.
- [ ] **Task:** Add quote view tracking with notification to owner.

### 8.2 Pricing & Margin
- [ ] **Task:** Display calculated margin on Quote Builder (next to total).
- [ ] **Task:** Show warning if discount drops margin below `margin_floor_percent`.

### 8.3 Bundles & Efficiency
- [ ] **Task:** Create `ProductBundle` model (name, products[], discount).
- [ ] **Task:** Add "Add Bundle" dropdown to Quote Builder.

### 8.4 Quote-to-Cash
- [ ] **Task:** Add "Convert to Invoice + Subscription" button on Quote detail.
- [ ] **Task:** Auto-trigger procurement flow if quote contains hardware.

---

## 9. Executive Enhancements

### 9.1 Executive Dashboard
- [ ] **Task:** Create dedicated Executive Dashboard (`/billing/executive`).
- [ ] **KPIs:** MRR, Churn Rate, Gross Margin, LTV, AR Aging (5 cards only).
- [ ] **Task:** Add MoM and YoY comparison to each metric.

### 9.2 Benchmarking
- [ ] **Task:** Integrate HTG/Service Leadership benchmark API.
- [ ] **Task:** Display "Your Metric vs Industry Average" on Executive Dashboard.

### 9.3 Alerts & Notifications
- [ ] **Task:** Create weekly email digest job for key financial metrics.
- [ ] **Task:** Create threshold-based alert system (e.g., Churn > 5%, AR Aging > $50k).
- [ ] **Task:** Send alert to Executive when thresholds are breached.

### 9.4 Client Health Score
- [ ] **Task:** Create composite "Client Health Score" algorithm.
- [ ] **Inputs:** Profitability, payment history (avg days to pay), support ticket volume, contract age.
- [ ] **Task:** Display Health Score on Company profile and Profitability report.

---

## 10. Accountant Enhancements

### 10.1 Export & Reporting
- [ ] **Task:** Add "Export to Excel" button on AR Aging report.
- [ ] **Task:** Create "Bulk Invoice PDF Export" (ZIP of PDFs for date range).
- [ ] **Task:** Verify Revenue Recognition UI is fully functional.

### 10.2 Access Control
- [ ] **Task:** Create "Accountant" role with read-only finance permissions.
- [ ] **Task:** Add 1099-MISC report generation (if contractor payments are tracked).

### 10.3 Reconciliation
- [ ] **Task:** Create "Payments Register" view (all payments, by method, with invoice links).
- [ ] **Task:** Create "Sales Tax by Jurisdiction" summary report.

---

## 11. Contract & Subscription Lifecycle

### 11.1 Contract Management
- [ ] **Task:** Add `contract_start_date` and `contract_end_date` to Subscription model.
- [ ] **Task:** Create "Contract Renewal" alert 60/30/15 days before expiration.
- [ ] **Task:** Add "Contract Document" upload (PDF of signed agreement).
- [ ] **Task:** Create "Contracts Expiring" dashboard widget.

### 11.2 Subscription Reconciliation
- [ ] **Task:** Create "Subscription vs Vendor License" reconciliation report.
- [ ] **Goal:** Flag clients billed for 50 users but vendor shows 75 licenses used.
- [ ] **Task:** Add manual/RMM sync to update subscription quantities.

### 11.3 Churn Prevention
- [ ] **Task:** Create "At-Risk Clients" report (low engagement + contract ending soon).
- [ ] **Task:** Trigger notification when client hasn't logged tickets in 30+ days.
- [ ] **Task:** Add "Renewal Opportunity" status to Subscription.

---

## 12. Mobile & Field Experience

### 12.1 Mobile-Optimized Technician UI
- [ ] **Task:** Audit Work Order Panel for mobile responsiveness.
- [ ] **Task:** Add large touch targets for time entry buttons.
- [ ] **Task:** Test barcode scanner on iOS/Android browsers.

### 12.2 Offline Capability (PWA)
- [ ] **Task:** Evaluate PWA for technician time entry.
- [ ] **Task:** Cache "My Tickets" list for offline viewing.
- [ ] **Task:** Queue time entries when offline, sync when connected.

### 12.3 Quick Actions
- [ ] **Task:** Add "Start Timer" widget to mobile home screen.
- [ ] **Task:** Add "Recent Tickets" quick access on technician dashboard.

---

## 13. Notification & Communication Hub

### 13.1 Multi-Channel Notifications
- [ ] **Task:** Add Slack integration for payment received alerts.
- [ ] **Task:** Add Microsoft Teams integration for invoice alerts.
- [ ] **Task:** Create SMS notification option for overdue invoices (Twilio).

### 13.2 In-App Notification Center
- [ ] **Task:** Create notification bell/dropdown in header.
- [ ] **Notifications:** New payment, quote accepted, contract expiring, anomaly detected.
- [ ] **Task:** Add "Mark all as read" and notification preferences.

### 13.3 Client Communication Log
- [ ] **Task:** Log all automated emails sent to clients (dunning, invoice, quote).
- [ ] **Task:** Surface communication log on Company profile.
- [ ] **Task:** Add "Resend Invoice" button with confirmation.

---

## 14. Audit & Compliance

### 14.1 Audit Trail
- [ ] **Task:** Log all invoice status changes with user and timestamp.
- [ ] **Task:** Log all payment recordings with user and method.
- [ ] **Task:** Log all price override changes.
- [ ] **Task:** Create "Audit Log" viewer for Finance Admin.

### 14.2 Data Integrity
- [ ] **Task:** Prevent invoice deletion after payment recorded.
- [ ] **Task:** Require reason for voiding an invoice.
- [ ] **Task:** Implement soft deletes on financial records.

### 14.3 Access Logging
- [ ] **Task:** Log all portal access by client users.
- [ ] **Task:** Log all financial report exports.
- [ ] **Task:** Create "Security Audit" report for SOC 2 compliance prep.

---

## 15. Automation & AI Enhancements

### 15.1 Smart Defaults
- [ ] **Task:** Auto-suggest pricing tier based on company size/industry.
- [ ] **Task:** Auto-populate line items from similar past quotes.
- [ ] **Task:** Predict payment date based on client history.

### 15.2 Anomaly Detection Improvements
- [ ] **Task:** Add ML model training on historical invoice data.
- [ ] **Task:** Detect unusual patterns: sudden drop in recurring revenue.
- [ ] **Task:** Flag clients with declining usage (potential churn).

### 15.3 Natural Language Search
- [ ] **Task:** Add search bar: "Show me all overdue invoices for Acme Corp".
- [ ] **Task:** Support date queries: "Invoices from last quarter".

---

## 16. Integration Ecosystem

### 16.1 Accounting Integrations
- [ ] **Task:** Add Xero two-way sync (in addition to QuickBooks).
- [ ] **Task:** Add Sage integration for enterprise clients.
- [ ] **Task:** Create generic CSV export for unsupported systems.

### 16.2 PSA/RMM Integrations
- [ ] **Task:** Add ConnectWise Manage sync (tickets, companies, products).
- [ ] **Task:** Add Datto RMM webhook handler.
- [ ] **Task:** Add NinjaRMM webhook handler.

### 16.3 Payment Gateways
- [ ] **Task:** Add PayPal as alternative payment method.
- [ ] **Task:** Add GoCardless for SEPA/BACS (European clients).
- [ ] **Task:** Add cryptocurrency payment option (optional, advanced).

---

## 17. Localization & Internationalization

### 17.1 Multi-Language Support
- [ ] **Task:** Extract all UI strings to language files.
- [ ] **Task:** Add Spanish language pack.
- [ ] **Task:** Add French language pack.
- [ ] **Task:** Allow per-company language preference.

### 17.2 Regional Formatting
- [ ] **Task:** Support date formats: MM/DD/YYYY, DD/MM/YYYY, YYYY-MM-DD.
- [ ] **Task:** Support number formats: 1,000.00 vs 1.000,00.
- [ ] **Task:** Display currency symbol based on locale.

---

## 18. Self-Service & Client Empowerment

### 18.1 Client Portal Enhancements
- [ ] **Task:** Add "Request Service Change" form (upgrade/downgrade).
- [ ] **Task:** Add "Schedule a Call" integration (Calendly/HubSpot).
- [ ] **Task:** Add live chat widget for billing questions.

### 18.2 Knowledge Base
- [ ] **Task:** Create "Billing FAQ" section in portal.
- [ ] **Task:** Add contextual help tooltips throughout portal.
- [ ] **Task:** Create video tutorials for common tasks (paying invoice, updating card).

---

## 19. Reporting & Business Intelligence

### 19.1 Custom Report Builder
- [ ] **Task:** Create drag-and-drop report builder.
- [ ] **Dimensions:** Date, Client, Product, Technician, Status.
- [ ] **Metrics:** Revenue, Hours, Margin, Count.
- [ ] **Task:** Save custom reports for reuse.

### 19.2 Scheduled Reports
- [ ] **Task:** Allow scheduling any report (daily, weekly, monthly).
- [ ] **Task:** Email report as PDF/Excel attachment.
- [ ] **Task:** Create "Report Subscriptions" management UI.

### 19.3 Dashboard Customization
- [ ] **Task:** Allow users to customize dashboard widget layout.
- [ ] **Task:** Add "Add Widget" button with widget library.
- [ ] **Task:** Save dashboard preferences per user.

---

## Priority Matrix (Updated)

| Section | Effort | Impact | Priority |
|---------|--------|--------|----------|
| 4.1 Quote-to-Cash | High | High | **P1** |
| 5.3 Retainers | High | High | **P1** |
| 5.4 Disputes/Credit Notes | Medium | High | **P1** |
| 11.1 Contract Management | Medium | High | **P1** |
| 14.1 Audit Trail | Medium | High | **P1** |
| 7.1 Portal Auto-Pay/PDF | Low | Medium | **P2** |
| 9.1 Executive Dashboard | Medium | High | **P2** |
| 13.2 In-App Notifications | Medium | Medium | **P2** |
| 12.1 Mobile Technician UI | Medium | Medium | **P2** |
| 19.2 Scheduled Reports | Medium | Medium | **P2** |
| 6.2 Inventory Integration | High | Medium | P3 |
| 10.2 Accountant Role | Low | Low | P3 |
| 15.3 Natural Language Search | High | Low | P3 |
| 17.1 Multi-Language | High | Medium | P3 |
| 16.3 Alt Payment Gateways | Medium | Low | P4 |
| 18.2 Knowledge Base | Low | Low | P4 |

